(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["FlashlightCloseupDotsCommon"],{"0PSK":function(e,t,n){var a=n("q1tI"),r=n.n(a);t.a=r.a.createContext(null)},Q3yk:function(e,t,n){t.a=e=>{const{images:t,image_signature:n}=e,a=t&&t["564x"]&&t.orig,{url:r}=a;let{width:i,height:s}=a;return i>564&&(s*=564/i,i=564),{width:i,height:s,url:r,imageSignature:n}}},dI71:function(e,t,n){function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.d(t,"a",(function(){return a}))},hLcf:function(e,t,n){var a=n("q1tI"),r=n.n(a),i=n("fMq/"),s=n("U4JR");function o({entrySource:e,showAnimation:t,auxData:n,index:o,isStela:c,onClick:l,onHover:u,onUnhover:p,spotlightCenter:h,viewParameter:d,viewType:f}){Object(a.useEffect)(()=>{e?Object(s.a)(120,{view:f,viewParameter:d,element:1260,commerce_data:JSON.stringify({entrypoint:e}),...n}):Object(s.a)(120,{element:1260,...n})},[]);const x=parseFloat((.1*(o+1)).toFixed(2)),m={animation:t?`spotlightDotPop 0.6s ease-out ${x}s both`:"none"};return r.a.createElement(i.a,{x:h.x,y:h.y,onClick:e=>{e&&(e.stopPropagation(),e.preventDefault()),Object(s.a)(101,{element:c?1221:1260,...n}),l(o)},onMouseEnter:e=>{e&&(e.stopPropagation(),e.preventDefault()),u(o)},onMouseLeave:e=>{e&&(e.stopPropagation(),e.preventDefault()),p()},style:m})}var c=n("uhAL");t.a=({entrySource:e,showAnimation:t,pinId:n,imageSignature:a,imageSize:i,currentSpotlightIdx:s,spotlightAreas:l,handleSpotlightClick:u,handleSpotlightHover:p,handleSpotlightUnhover:h,viewParameter:d,viewType:f})=>l.map((l,x)=>{if(x===s)return null;const m=Object(c.e)({cropArea:l,scaledWidth:i.w,scaledHeight:i.h}),E={x:m.x+m.w/2,y:m.y+m.h/2},g={commerce_data:JSON.stringify({entrypoint:e}),pin_id:n,image_signature:a,visual_objects:JSON.stringify([{x:l.x,y:l.y,w:l.w,h:l.h}])},v=`${E.x}${E.y}`;return r.a.createElement(o,{entrySource:e,showAnimation:t,auxData:g,index:x,isStela:!!l.is_stela,key:v,onClick:u,onHover:p,onUnhover:h,spotlightCenter:E,viewParameter:d,viewType:f})})},pQ8y:function(e,t,n){var a=n("wx14"),r=n("zLVn"),i=n("dI71");n("17x9");function s(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var o=n("q1tI"),c=n.n(o),l=n("i8i4"),u=n.n(l),p=!1,h=n("0PSK"),d="unmounted",f="exited",x="entering",m="entered",E=function(e){function t(t,n){var a;a=e.call(this,t,n)||this;var r,i=n&&!n.isMounting?t.enter:t.appear;return a.appearStatus=null,t.in?i?(r=f,a.appearStatus=x):r=m:r=t.unmountOnExit||t.mountOnEnter?d:f,a.state={status:r},a.nextCallback=null,a}Object(i.a)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===d?{status:f}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==x&&n!==m&&(t=x):n!==x&&n!==m||(t="exiting")}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,a=this.props.timeout;return e=t=n=a,null!=a&&"number"!=typeof a&&(e=a.exit,t=a.enter,n=void 0!==a.appear?a.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var n=u.a.findDOMNode(this);t===x?this.performEnter(n,e):this.performExit(n)}else this.props.unmountOnExit&&this.state.status===f&&this.setState({status:d})},n.performEnter=function(e,t){var n=this,a=this.props.enter,r=this.context?this.context.isMounting:t,i=this.getTimeouts(),s=r?i.appear:i.enter;!t&&!a||p?this.safeSetState({status:m},(function(){n.props.onEntered(e)})):(this.props.onEnter(e,r),this.safeSetState({status:x},(function(){n.props.onEntering(e,r),n.onTransitionEnd(e,s,(function(){n.safeSetState({status:m},(function(){n.props.onEntered(e,r)}))}))})))},n.performExit=function(e){var t=this,n=this.props.exit,a=this.getTimeouts();n&&!p?(this.props.onExit(e),this.safeSetState({status:"exiting"},(function(){t.props.onExiting(e),t.onTransitionEnd(e,a.exit,(function(){t.safeSetState({status:f},(function(){t.props.onExited(e)}))}))}))):this.safeSetState({status:f},(function(){t.props.onExited(e)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(a){n&&(n=!1,t.nextCallback=null,e(a))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t,n){this.setNextCallback(n);var a=null==t&&!this.props.addEndListener;e&&!a?(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t)):setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===d)return null;var t=this.props,n=t.children,a=Object(r.a)(t,["children"]);if(delete a.in,delete a.mountOnEnter,delete a.unmountOnExit,delete a.appear,delete a.enter,delete a.exit,delete a.timeout,delete a.addEndListener,delete a.onEnter,delete a.onEntering,delete a.onEntered,delete a.onExit,delete a.onExiting,delete a.onExited,"function"==typeof n)return c.a.createElement(h.a.Provider,{value:null},n(e,a));var i=c.a.Children.only(n);return c.a.createElement(h.a.Provider,{value:null},c.a.cloneElement(i,a))},t}(c.a.Component);function g(){}E.contextType=h.a,E.propTypes={},E.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:g,onEntering:g,onEntered:g,onExit:g,onExiting:g,onExited:g},E.UNMOUNTED=0,E.EXITED=1,E.ENTERING=2,E.ENTERED=3,E.EXITING=4;var v=E,y=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return a=t,void((n=e).classList?n.classList.remove(a):"string"==typeof n.className?n.className=s(n.className,a):n.setAttribute("class",s(n.className&&n.className.baseVal||"",a)));var n,a}))},b=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){t.removeClasses(e,"exit"),t.addClass(e,n?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var a=n?"appear":"enter";t.addClass(e,a,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var a=n?"appear":"enter";t.removeClasses(e,a),t.addClass(e,a,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){t.removeClasses(e,"appear"),t.removeClasses(e,"enter"),t.addClass(e,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){t.addClass(e,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){t.removeClasses(e,"exit"),t.addClass(e,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.getClassNames=function(e){var n=t.props.classNames,a="string"==typeof n,r=a?""+(a&&n?n+"-":"")+e:n[e];return{baseClassName:r,activeClassName:a?r+"-active":n[e+"Active"],doneClassName:a?r+"-done":n[e+"Done"]}},t}Object(i.a)(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var a=this.getClassNames(t)[n+"ClassName"];"appear"===t&&"done"===n&&(a+=" "+this.getClassNames("enter").doneClassName),"active"===n&&e&&e.scrollTop,this.appliedClasses[t][n]=a,function(e,t){e&&t&&t.split(" ").forEach((function(t){return a=t,void((n=e).classList?n.classList.add(a):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,a)||("string"==typeof n.className?n.className=n.className+" "+a:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+a)));var n,a}))}(e,a)},n.removeClasses=function(e,t){var n=this.appliedClasses[t],a=n.base,r=n.active,i=n.done;this.appliedClasses[t]={},a&&y(e,a),r&&y(e,r),i&&y(e,i)},n.render=function(){var e=this.props,t=(e.classNames,Object(r.a)(e,["classNames"]));return c.a.createElement(v,Object(a.a)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(c.a.Component);b.defaultProps={classNames:""},b.propTypes={};t.a=b},qqi8:function(e,t,n){n.r(t);var a=n("q1tI"),r=n.n(a),i=n("jkxn"),s=n("hLcf"),o=n("Q3yk"),c=n("n6mq"),l=n("pQ8y"),u=n("dtw8"),p=n("uhAL");t.default=Object(u.withRouter)((function({pin:e,isHovered:t,router:n,width:u,height:h,dangerouslyForceZIndex:d}){const[f,x]=Object(a.useState)({x:0,y:0,w:0,h:0}),[m,E]=Object(a.useState)(!1),{id:g}=e,v=e=>e/100,{pin_tags:y}=e.aggregated_pin_data||{};if(!y)return null;const b=y;return r.a.createElement(c.c,{position:"absolute",width:u,height:h,dangerouslySetInlineStyle:{__style:{pointerEvents:"none",...d?{zIndex:2}:{}}}},r.a.createElement("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}},r.a.createElement("defs",null,r.a.createElement("mask",{id:"Mask"},r.a.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",rx:"0",ry:"0",fill:"#FFF"}),r.a.createElement(l.a,{in:m,timeout:300,classNames:"preview-crop-area",mountOnEnter:!0,unmountOnExit:!0},r.a.createElement("rect",{key:`${f.x}${f.y}`,x:f.x,y:f.y,width:f.w,height:f.h,id:"preview",rx:4,ry:4})))),r.a.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",style:{fill:t?"rgba(0,0,0,0.3)":"rgba(0,0,0,0.0)"},mask:"url(#Mask)"})),Object(i.a)(r.a.createElement(s.a,{imageSize:{w:u,h},handleSpotlightClick:t=>{const a=b[t],{width:r,height:i}=Object(o.a)(e),s=Object(p.e)({cropArea:{x:v(a.x_percent),y:v(a.y_percent),w:v(a.bbox_width),h:v(a.bbox_height)},scaledWidth:r,scaledHeight:i}),c=Object(p.g)({cropArea:s,pinId:g,cropSource:4});n.push(c)},handleSpotlightHover:e=>{const t=b[e],n=Object(p.e)({cropArea:{x:v(t.x_percent),y:v(t.y_percent),w:v(t.bbox_width),h:v(t.bbox_height)},scaledWidth:u,scaledHeight:h});x(n),E(!0)},handleSpotlightUnhover:()=>{E(!1)},pinId:g,showAnimation:!0,currentSpotlightIdx:-1,spotlightAreas:(e=>e.map(e=>({x:e.x_percent/100,y:e.y_percent/100,w:e.bbox_width/100,h:e.bbox_height/100,is_stela:!0})))(b)})))}))},uhAL:function(e,t,n){function a(e,t,n){return Object.keys(e).reduce((n,a)=>n+Math.abs(e[a]-t[a]),0)<=n}function r({cropArea:{x:e,y:t,w:n,h:a},scaledWidth:r,scaledHeight:i}){return{x:e/r,y:t/i,w:n/r,h:a/i}}function i({cropArea:{x:e,y:t,w:n,h:a},scaledWidth:r,scaledHeight:i}){return{h:Math.floor(a*i),w:Math.floor(n*r),x:Math.floor(e*r),y:Math.floor(t*i)}}function s({cropArea:{x:e,y:t,w:n,h:a},cropSource:r,searchQuery:i,entrySource:s,tab:o,trafficSource:c}){const l=[];return e>=0&&t>=0&&n>=0&&a>=0&&l.push(`x=${e}`,`y=${t}`,`w=${n}`,`h=${a}`),r&&l.push(`cropSource=${r}`),s&&l.push(`entrySource=${s}`),i&&l.push(`q=${i}`),c&&"unknown"!==c&&l.push(`rs=${c}`),o&&l.push(`tab=${o}`),l.length?`?${l.join("&")}`:""}function o({cropArea:e,cropSource:t,entrySource:n,isUnified:a,pinId:r,searchQuery:i,trafficSource:o,view:c}){return`/pin/${r}/${a?"visual-products":"visual-search"}/${a||"products"!==c?"":"products/"}${s({cropArea:e,cropSource:t,entrySource:n,trafficSource:o,searchQuery:i})}`}function c(e){return e.filter(e=>e.is_stela)}function l(e){return e.filter(e=>!!e.label)}n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return a}))}}]);
//# sourceMappingURL=pjs-FlashlightCloseupDotsCommon-a50066c45f918b313adf.mjs.map
